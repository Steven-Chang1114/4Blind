{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nvar _jsxFileName = \"/Users/stevenchang/GitHub/4Blind/App.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { useState, useEffect, Component } from 'react';\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport StatusBar from \"react-native-web/dist/exports/StatusBar\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport { Colors } from 'react-native/Libraries/NewAppScreen';\nimport { Camera } from 'expo-camera';\nimport * as FaceDetector from 'expo-face-detector';\nimport { AntDesign } from '@expo/vector-icons';\nimport { Audio } from 'expo-av';\nvar soundObject = new Audio.Sound();\n\nvar App = function (_Component) {\n  _inherits(App, _Component);\n\n  var _super = _createSuper(App);\n\n  function App() {\n    var _this;\n\n    _classCallCheck(this, App);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n    _this.state = {\n      hasPermission: null,\n      type: Camera.Constants.Type.back,\n      faces: [],\n      picture: null,\n      hasMask: false,\n      audioPlaying: true,\n      tooclose: false,\n      dist: 0\n    };\n\n    _this.onFacesDetected = function (obj) {\n      _this.setState({\n        faces: obj.faces\n      });\n\n      if (_this.state.dist > 5000 && _this.state.audioPlaying) {\n        _this.setState({\n          audioPlaying: false\n        });\n\n        _this.playSound();\n      }\n\n      setTimeout(function _callee2() {\n        var photo;\n        return _regeneratorRuntime.async(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.next = 2;\n                return _regeneratorRuntime.awrap(_this.camera.takePictureAsync({\n                  base64: true\n                }));\n\n              case 2:\n                photo = _context2.sent;\n                console.log(photo.base64);\n\n                postImage = function _callee(photo) {\n                  var user, json;\n                  return _regeneratorRuntime.async(function _callee$(_context) {\n                    while (1) {\n                      switch (_context.prev = _context.next) {\n                        case 0:\n                          _context.next = 2;\n                          return _regeneratorRuntime.awrap(fetch('', {\n                            method: \"POST\",\n                            headers: {\n                              'Accept': 'application/json',\n                              'Content-Type': 'application/json'\n                            },\n                            body: JSON.stringify({\n                              uri: photo.uri,\n                              base64: photo.base64\n                            })\n                          }));\n\n                        case 2:\n                          user = _context.sent;\n                          _context.next = 5;\n                          return _regeneratorRuntime.awrap(response.json());\n\n                        case 5:\n                          json = _context.sent;\n                          json = json.user;\n                          return _context.abrupt(\"return\", json);\n\n                        case 8:\n                        case \"end\":\n                          return _context.stop();\n                      }\n                    }\n                  }, null, null, null, Promise);\n                }(photo);\n\n              case 5:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, null, null, null, Promise);\n      }, 1000);\n    };\n\n    _this.playSound = function () {\n      soundObject.playAsync();\n      soundObject.replayAsync();\n      setTimeout(function () {\n        _this.setState({\n          audioPlaying: true\n        });\n      }, 4000);\n    };\n\n    _this.renderFaces = function () {\n      return React.createElement(View, {\n        style: styles.facesContainer,\n        pointerEvents: \"none\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 3\n        }\n      }, _this.state.faces.map(_this.renderFace));\n    };\n\n    _this.renderFace = function (_ref) {\n      var bounds = _ref.bounds,\n          faceID = _ref.faceID,\n          rollAngle = _ref.rollAngle,\n          yawAngle = _ref.yawAngle,\n          leftCheekPosition = _ref.leftCheekPosition,\n          leftMouthPosition = _ref.leftMouthPosition,\n          noseBasePosition = _ref.noseBasePosition,\n          rightCheekPosition = _ref.rightCheekPosition,\n          rightMouthPosition = _ref.rightMouthPosition;\n      var size = bounds.size.height * bounds.size.width;\n      setTimeout(function () {\n        _this.setState({\n          dist: size\n        });\n      }, 1000);\n      var styleOpt;\n\n      if (size > 5000) {\n        styleOpt = styles.face;\n      } else {\n        styleOpt = styles.face_warning;\n      }\n\n      return React.createElement(View, {\n        key: faceID,\n        transform: [{\n          perspective: 600\n        }, {\n          rotateZ: rollAngle.toFixed(0) + \"deg\"\n        }, {\n          rotateY: yawAngle.toFixed(0) + \"deg\"\n        }],\n        style: [styleOpt, _objectSpread(_objectSpread({}, bounds.size), {}, {\n          left: bounds.origin.x,\n          top: bounds.origin.y\n        })],\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 137,\n          columnNumber: 7\n        }\n      }, React.createElement(Text, {\n        style: styles.faceText,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 152,\n          columnNumber: 9\n        }\n      }, \"size: \", size));\n    };\n\n    return _this;\n  }\n\n  _createClass(App, [{\n    key: \"componentWillMount\",\n    value: function componentWillMount() {\n      var _this2 = this;\n\n      (function _callee3() {\n        var _await$Camera$request, status, playback;\n\n        return _regeneratorRuntime.async(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.next = 2;\n                return _regeneratorRuntime.awrap(Camera.requestPermissionsAsync());\n\n              case 2:\n                _await$Camera$request = _context3.sent;\n                status = _await$Camera$request.status;\n\n                _this2.setState({\n                  hasPermission: status === 'granted'\n                });\n\n                _context3.next = 7;\n                return _regeneratorRuntime.awrap(soundObject.loadAsync(require(\"./tooclose.mp3\")));\n\n              case 7:\n                Audio.setAudioModeAsync({\n                  playsInSilentModeIOS: true\n                });\n                _context3.next = 10;\n                return _regeneratorRuntime.awrap(Audio.Sound.createAsync(require(\"./welcome.mp3\"), {\n                  shouldPlay: true\n                }));\n\n              case 10:\n                playback = _context3.sent;\n\n              case 11:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, null, null, null, Promise);\n      })();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      if (this.state.hasPermission === null) {\n        return React.createElement(View, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 161,\n            columnNumber: 14\n          }\n        });\n      }\n\n      if (this.state.hasPermission === false) {\n        return React.createElement(Text, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 164,\n            columnNumber: 14\n          }\n        }, \"No access to camera\");\n      } else return React.createElement(View, {\n        style: {\n          flex: 1\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 166,\n          columnNumber: 7\n        }\n      }, React.createElement(Camera, {\n        ref: function ref(_ref2) {\n          _this3.camera = _ref2;\n        },\n        style: {\n          flex: 1\n        },\n        type: this.state.type,\n        onFacesDetected: this.onFacesDetected,\n        faceDetectorSettings: {\n          mode: FaceDetector.Constants.Mode.fast,\n          detectLandmarks: FaceDetector.Constants.Landmarks.all,\n          runClassifications: FaceDetector.Constants.Classifications.all,\n          minDetectionInterval: 100,\n          tracking: true\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 167,\n          columnNumber: 9\n        }\n      }, React.createElement(View, {\n        style: {\n          flex: 1,\n          backgroundColor: 'transparent',\n          flexDirection: 'row'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 182,\n          columnNumber: 11\n        }\n      }, React.createElement(TouchableOpacity, {\n        style: {\n          flex: 0.1,\n          alignSelf: 'flex-end',\n          alignItems: 'center'\n        },\n        onPress: function onPress() {\n          if (_this3.state.type === Camera.Constants.Type.back) {\n            _this3.setState({\n              type: Camera.Constants.Type.front\n            });\n          } else {\n            _this3.setState({\n              type: Camera.Constants.Type.back\n            });\n          }\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 188,\n          columnNumber: 13\n        }\n      }, React.createElement(AntDesign, {\n        name: \"retweet\",\n        size: 80,\n        style: {\n          marginLeft: 100,\n          width: 100\n        },\n        color: \"black\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 202,\n          columnNumber: 15\n        }\n      })))), this.renderFaces());\n    }\n  }]);\n\n  return App;\n}(Component);\n\nvar styles = StyleSheet.create({\n  scrollView: {\n    backgroundColor: Colors.lighter\n  },\n  engine: {\n    position: 'absolute',\n    right: 0\n  },\n  body: {\n    backgroundColor: Colors.white\n  },\n  sectionContainer: {\n    marginTop: 32,\n    paddingHorizontal: 24\n  },\n  sectionTitle: {\n    fontSize: 24,\n    fontWeight: '600',\n    color: Colors.black\n  },\n  sectionDescription: {\n    marginTop: 8,\n    fontSize: 18,\n    fontWeight: '400',\n    color: Colors.dark\n  },\n  highlight: {\n    fontWeight: '700'\n  },\n  footer: {\n    color: Colors.dark,\n    fontSize: 12,\n    fontWeight: '600',\n    padding: 4,\n    paddingRight: 12,\n    textAlign: 'right'\n  },\n  facesContainer: {\n    position: 'absolute',\n    bottom: 0,\n    right: 0,\n    left: 0,\n    top: 0\n  },\n  face: {\n    padding: 10,\n    borderWidth: 2,\n    borderRadius: 2,\n    position: 'absolute',\n    borderColor: '#FFD700',\n    justifyContent: 'center',\n    backgroundColor: 'rgba(0, 0, 0, 0.5)'\n  },\n  face_warning: {\n    padding: 10,\n    borderWidth: 2,\n    borderRadius: 2,\n    position: 'absolute',\n    borderColor: '#FF0000',\n    justifyContent: 'center',\n    backgroundColor: 'rgba(0, 0, 0, 0.5)'\n  },\n  faceText: {\n    color: '#FFD700',\n    fontWeight: 'bold',\n    textAlign: 'center',\n    margin: 10,\n    backgroundColor: 'transparent'\n  }\n});\nexport default App;","map":{"version":3,"sources":["/Users/stevenchang/GitHub/4Blind/App.js"],"names":["React","useState","useEffect","Component","Colors","Camera","FaceDetector","AntDesign","Audio","soundObject","Sound","App","state","hasPermission","type","Constants","Type","back","faces","picture","hasMask","audioPlaying","tooclose","dist","onFacesDetected","obj","setState","playSound","setTimeout","camera","takePictureAsync","base64","photo","console","log","postImage","fetch","method","headers","body","JSON","stringify","uri","user","response","json","playAsync","replayAsync","renderFaces","styles","facesContainer","map","renderFace","bounds","faceID","rollAngle","yawAngle","leftCheekPosition","leftMouthPosition","noseBasePosition","rightCheekPosition","rightMouthPosition","size","height","width","styleOpt","face","face_warning","perspective","rotateZ","toFixed","rotateY","left","origin","x","top","y","faceText","requestPermissionsAsync","status","loadAsync","require","setAudioModeAsync","playsInSilentModeIOS","createAsync","shouldPlay","playback","flex","ref","mode","Mode","fast","detectLandmarks","Landmarks","all","runClassifications","Classifications","minDetectionInterval","tracking","backgroundColor","flexDirection","alignSelf","alignItems","front","marginLeft","StyleSheet","create","scrollView","lighter","engine","position","right","white","sectionContainer","marginTop","paddingHorizontal","sectionTitle","fontSize","fontWeight","color","black","sectionDescription","dark","highlight","footer","padding","paddingRight","textAlign","bottom","borderWidth","borderRadius","borderColor","justifyContent","margin"],"mappings":"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","sourcesContent":["/**\n * Sample React Native App\n * https://github.com/facebook/react-native\n *\n * @format\n * @flow strict-local\n */\n\nimport React, { useState, useEffect, Component } from 'react';\n\nimport {\n  StyleSheet,\n  View,\n  Text,\n  StatusBar,\n  TouchableOpacity\n} from 'react-native';\n\nimport {\n  Colors,\n} from 'react-native/Libraries/NewAppScreen';\n\nimport { Camera } from 'expo-camera';\n\nimport * as FaceDetector from 'expo-face-detector';\n\n//import { bundleResourceIO } from '@tensorflow/tfjs-react-native';\n\nimport { AntDesign } from '@expo/vector-icons';\n\n// import { Player } from '@react-native-community/audio-toolkit';\n// import SoundPlayer from 'react-native-sound-player'\n// var Sound = require('react-native-sound');\nimport { Audio } from 'expo-av';\n\n// const filename = './audio/welcome.mp3'\nconst soundObject = new Audio.Sound();\n\n\nclass App extends Component {\n  \n  state = {\n    hasPermission: null,\n    type: Camera.Constants.Type.back,\n    faces: [],\n    picture: null,\n    hasMask: false,\n    audioPlaying: true,\n    tooclose: false,\n    dist: 0,\n  }\n\n  model\n\n  componentWillMount(){\n    (async () => {\n        const { status } = await Camera.requestPermissionsAsync();\n        // Get permission\n        this.setState({hasPermission: status === 'granted'});\n\n        // Load audio for welcome screen and warning\n        await soundObject.loadAsync(require('./tooclose.mp3'));\n        Audio.setAudioModeAsync({playsInSilentModeIOS : true})\n\n        // Welcome audio\n        const playback = await Audio.Sound.createAsync(\n              require('./welcome.mp3'),\n              { shouldPlay: true }\n            )\n    })();\n  }\n\n  onFacesDetected = (obj) => {\n    //if(obj.faces[0])console.log(obj.faces[0].noseBasePosition)\n    this.setState({ faces: obj.faces });\n\n    // if too close, play the audio\n    if (this.state.dist > 5000 && this.state.audioPlaying) {\n      this.setState({audioPlaying: false});\n      this.playSound();\n    }\n\n    // send pic to backend to process\n    setTimeout(async () => {\n      let photo = await this.camera.takePictureAsync({base64: true});\n      // console.ignoredYellowBox = ['Warning: Each', 'Warning: Failed'];\n      //console.log(photo.uri)\n      //Do the api call\n      \n      console.log(photo.base64);\n\n      postImage = (async (photo) => {\n        let user = await fetch('', {\n            method: \"POST\",\n            headers: {\n                'Accept': 'application/json',\n                'Content-Type': 'application/json'\n            }, \n            body: JSON.stringify({uri: photo.uri, base64: photo.base64})\n        })\n        let json = await response.json()\n        json = json.user\n        return json\n      })(photo);\n\n    }, 1000)\n  }\n\n\n  playSound = () => {\n      soundObject.playAsync();\n      soundObject.replayAsync();\n      setTimeout(() => {\n        this.setState({audioPlaying: true});\n        }, 4000);\n  }\n\n  renderFaces = () => \n  <View style={styles.facesContainer} pointerEvents=\"none\">\n    {this.state.faces.map(this.renderFace)}\n  </View>\n\n\n  renderFace = ({ bounds, faceID, rollAngle, yawAngle,leftCheekPosition,leftMouthPosition, noseBasePosition, rightCheekPosition, rightMouthPosition }) => {\n    const size = bounds.size.height * bounds.size.width; // compute face size to determine approximate distance\n    setTimeout(() => {\n      this.setState({ dist: size });\n      }, 1000);\n    let styleOpt;\n    if(size > 5000){\n      styleOpt = styles.face\n    } else {\n      styleOpt = styles.face_warning\n    }\n\n    return (\n      <View\n        key={faceID}\n        transform={[\n          { perspective: 600 },\n          { rotateZ: `${rollAngle.toFixed(0)}deg` },\n          { rotateY: `${yawAngle.toFixed(0)}deg` },\n        ]}\n        style={[\n          styleOpt,\n          {\n            ...bounds.size,\n            left: bounds.origin.x,\n            top: bounds.origin.y,\n          },\n        ]}>\n        <Text style={styles.faceText}>size: {size}</Text>\n\n      </View>\n    );\n  }\n\n  render(){\n\n    if (this.state.hasPermission === null) {\n      return <View />;\n    }\n    if (this.state.hasPermission === false) {\n      return <Text>No access to camera</Text>;\n    }else return (\n      <View style={{ flex: 1 }}>\n        <Camera\n          ref={ref => {\n            this.camera = ref;\n          }}\n          style={{ flex: 1 }} \n          type={this.state.type}\n          onFacesDetected={this.onFacesDetected}\n          faceDetectorSettings={{\n            mode: FaceDetector.Constants.Mode.fast,\n            detectLandmarks: FaceDetector.Constants.Landmarks.all,\n            runClassifications: FaceDetector.Constants.Classifications.all,\n            minDetectionInterval: 100,\n            tracking: true,\n          }}\n          >\n          <View\n            style={{\n              flex: 1,\n              backgroundColor: 'transparent',\n              flexDirection: 'row',\n            }}>\n            <TouchableOpacity\n              style={{\n                flex: 0.1,\n                alignSelf: 'flex-end',\n                alignItems: 'center',\n              }}\n              onPress={() => {\n                if(this.state.type === Camera.Constants.Type.back){\n                  this.setState({type: Camera.Constants.Type.front});\n                }else{\n                  this.setState({type: Camera.Constants.Type.back})\n                }\n              }}>\n  \n              <AntDesign name=\"retweet\" size={80} style={{marginLeft: 100, width: 100}} color=\"black\" />\n              \n            </TouchableOpacity>\n          </View>\n        </Camera>\n        {this.renderFaces()}\n      </View>\n    );\n  }\n\n}\n\nconst styles = StyleSheet.create({\n  scrollView: {\n    backgroundColor: Colors.lighter,\n  },\n  engine: {\n    position: 'absolute',\n    right: 0,\n  },\n  body: {\n    backgroundColor: Colors.white,\n  },\n  sectionContainer: {\n    marginTop: 32,\n    paddingHorizontal: 24,\n  },\n  sectionTitle: {\n    fontSize: 24,\n    fontWeight: '600',\n    color: Colors.black,\n  },\n  sectionDescription: {\n    marginTop: 8,\n    fontSize: 18,\n    fontWeight: '400',\n    color: Colors.dark,\n  },\n  highlight: {\n    fontWeight: '700',\n  },\n  footer: {\n    color: Colors.dark,\n    fontSize: 12,\n    fontWeight: '600',\n    padding: 4,\n    paddingRight: 12,\n    textAlign: 'right',\n  },\n  facesContainer: {\n    position: 'absolute',\n    bottom: 0,\n    right: 0,\n    left: 0,\n    top: 0,\n  },\n  face: {\n    padding: 10,\n    borderWidth: 2,\n    borderRadius: 2,\n    position: 'absolute',\n    borderColor: '#FFD700',\n    justifyContent: 'center',\n    backgroundColor: 'rgba(0, 0, 0, 0.5)',\n  },\n  face_warning: {\n    padding: 10,\n    borderWidth: 2,\n    borderRadius: 2,\n    position: 'absolute',\n    borderColor: '#FF0000',\n    justifyContent: 'center',\n    backgroundColor: 'rgba(0, 0, 0, 0.5)',\n  },\n  faceText: {\n    color: '#FFD700',\n    fontWeight: 'bold',\n    textAlign: 'center',\n    margin: 10,\n    backgroundColor: 'transparent',\n  },\n});\n\nexport default App;"]},"metadata":{},"sourceType":"module"}